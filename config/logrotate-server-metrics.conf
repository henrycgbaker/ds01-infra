# Logrotate configuration for server metrics
# Metrics logs - 5 minute interval collection
/home/datasciencelab/server_infra/logs/metrics/*.log {
    # Rotate daily at midnight
    daily
    
    # Keep 14 days of logs
    rotate 14
    
    # Don't error if log file is missing
    missingok
    
    # Don't rotate if empty
    notifempty
    
    # Compress rotated logs
    compress
    
    # Delay compression until next rotation
    delaycompress
    
    # Create new log file with these permissions
    create 0644 datasciencelab datasciencelab
    
    # Use date extension for rotated files (YYYYMMDD)
    dateext
    dateformat -%Y%m%d
    
    # Don't mail logs
    nomail
    
    # Rotate even if multiple logs haven't been accessed
    sharedscripts
    
    # Post-rotation script
    postrotate
        find /home/datasciencelab/server_infra/logs/metrics -name "*.log" -mtime +1 ! -name "*.gz" -exec gzip {} \; 2>/dev/null || true
    endscript
}

# Cron logs
/home/datasciencelab/server_infra/logs/cron.log {
    weekly
    rotate 4
    missingok
    notifempty
    compress
    delaycompress
    create 0644 datasciencelab datasciencelab
}
